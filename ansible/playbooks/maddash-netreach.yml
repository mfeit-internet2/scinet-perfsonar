# perfSONAR config

- name: perfSONAR MadDash
  tags: maddash
  hosts: ps-maddash
  tasks:
    - name: ps-maddash
      debug:
        var: groups['ps-maddash']
    - name: change maddash throughput graph scale for 10GB networks
      command: > 
        psconfig maddash-grid edit --name default_throughput
        --check-critical-threshold 6 --check-warning-threshold 9
    - name: copy ps-nagios-netreach.json
      copy:
        src: {{ playbook_dir }}/files/ps-nagios-netreach.json
        dest: /usr/lib/perfsonar/psconfig/checks/
        owner: perfsonar
        group: perfsonar
        mode: '0644'
    - name: copy default-netreach.json
      copy:
        src: {{ playbook_dir }}/files/default-netreach.json
        dest: /tmp
        owner: perfsonar
        group: perfsonar
        mode: '0644'
    - name: copy install-default-netreach.sh
      copy:
        src: {{ playbook_dir }}/files/install-default-netreach.sh
        dest: /tmp
        owner: perfsonar
        group: perfsonar
        mode: '0644'
    - name: run install-default-netreach.sh
      command: /tmp/install-default-netreach.sh /tmp/default-netreach.json
